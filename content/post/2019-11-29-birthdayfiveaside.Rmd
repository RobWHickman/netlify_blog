---
title: "Untitled"
output: html_document
---

```{r warning=FALSE,message=FALSE}
library(tidyverse)

data <- readRDS("C:/Users/robwh/Desktop/packages/fifa_database/all_players.rds") %>%
  mutate(dob = as.Date(dob, "%b %d, %Y")) %>%
  mutate(name = gsub("L$", "", name)) %>%
  mutate(name = case_when(
    name == "C. Ronaldo" ~ "Cristiano Ronaldo",
    name == "Neymar" ~ "Neymar Jr.",
    TRUE ~ name
  ))

birth_days <- data %>%
  mutate(birth_date = gsub("[0-9]{4}-", "", dob)) %>%
  filter(birth_date != "02-29") %>%
  split(f = .$birth_date) %>%
  map_df(., function(x) {
    team <- x %>%
      arrange(ability) %>%
      filter(!duplicated(name)) %>%
      .[1:5,] %>%
      select(name, team, version, position, ability, birth_date)
  })

x <- birth_days %>%
    group_by(birth_date) %>%
    summarise(strength = mean(as.numeric(as.character(ability))))
```

